import{_ as j,b as N}from"./BZfyVz6G.js";import{_ as S}from"./D_MPiM5j.js";import{e as U,f as R,g as G,p as I,m as q,a7 as f,q as z,G as B,c,k as h,a as t,d as y,t as v,b as o,h as l,y as M,Q as T,r as V,z as E,o as u,l as P,n as A}from"./BKcyA04J.js";import"./D699539O.js";import"./DlAUqK2U.js";import"./B6A3F-fM.js";import"./DjK9N5UA.js";const D={class:"h-screen h-[100dvh] overflow-hidden bg-slate-50 dark:bg-slate-950 flex text-slate-900 dark:text-slate-100 transition-colors duration-300"},L={class:"px-6 py-4 border-b border-slate-800 shrink-0"},O={key:0,class:"mt-2 animate-fade-in block space-y-0.5"},F={class:"text-sm font-bold text-white truncate"},Q={class:"text-xs font-semibold text-emerald-400 truncate"},W={class:"text-xs text-slate-400 flex items-center gap-1"},H={class:"flex-1 p-4 space-y-4 mt-4 overflow-y-auto custom-scrollbar"},J={key:0,class:"pt-4 mt-4 border-t border-slate-800"},K={key:1,class:"pt-4 mt-4 border-t border-slate-800"},X={class:"p-4 border-t border-slate-800 space-y-2 shrink-0"},Y={class:"flex justify-between items-center px-2"},Z={class:"text-center pt-2"},ee={class:"text-[10px] text-slate-600 dark:text-slate-500"},te={class:"md:hidden fixed top-0 w-full bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 z-40 flex items-center justify-between p-4 shadow-md transition-colors duration-300"},se={class:"flex items-center gap-2"},ae={key:0,class:"text-slate-400 font-medium"},oe={key:1,class:"font-bold text-lg text-slate-900 dark:text-white truncate max-w-[150px]"},le={class:"flex gap-2"},re={class:"flex-1 overflow-auto bg-slate-50 dark:bg-slate-950 relative w-full flex flex-col pt-16 md:pt-0"},ne={class:"flex-1 p-2 md:p-6 overflow-y-auto"},me=U({__name:"default",setup(ie){const b=R();G();const _=I(),p=q(),$=P(),n=f("tenantSlug",()=>_.params.slug||""),m=f("headerTitle"),s=V(!1),x=f("userRole",()=>null),C=async()=>{await b.auth.signOut(),A("/login")},i=E({role:null,tenantName:"",branchName:"",fullName:""}),w=async()=>{let d=p.value?.id;if(!d){const{data:{user:a}}=await b.auth.getUser();a&&(d=a.id,console.log("User ID recovered from getUser:",d))}if(!d){console.log("Waiting for user...");return}console.log("Fetching info for user:",d);const{data:e,error:g}=await b.from("profiles").select(`
            role,
            full_name,
            tenants ( name, slug ),
            branches ( name )
        `).eq("id",d).single();if(g){console.error("Error fetching user info:",g);return}e?(x.value=e.role,i.role=e.role,i.fullName=e.full_name||"",i.tenantName=e.tenants?.name||"",i.branchName=e.branches?.name||"",e.tenants?.slug&&(n.value=e.tenants.slug),console.log("User Info Loaded:",i)):console.log("No profile found for this user.")};return z(p,()=>{w()},{immediate:!0}),B(()=>{setTimeout(w,1e3)}),(d,e)=>{const g=N,a=j,k=S;return u(),c("div",D,[s.value?(u(),c("div",{key:0,class:"fixed inset-0 bg-slate-900/50 z-40 md:hidden backdrop-blur-sm",onClick:e[0]||(e[0]=r=>s.value=!1)})):h("",!0),t("aside",{class:M(["w-72 bg-slate-900 dark:bg-slate-900/90 text-white flex flex-col shadow-xl border-r border-slate-800 fixed md:static inset-y-0 left-0 z-50 transition-transform duration-300 transform md:transform-none",s.value?"translate-x-0":"-translate-x-full md:translate-x-0"])},[t("div",L,[e[14]||(e[14]=t("h1",{class:"font-extrabold text-2xl tracking-tight text-emerald-400"},[y(" Gestor"),t("span",{class:"text-white"},"Estilista")],-1)),i.tenantName?(u(),c("div",O,[t("div",F,v(i.fullName||"Usuario"),1),t("div",Q,v(i.tenantName),1),t("div",W,[o(g,{name:"i-heroicons-map-pin",class:"w-3 h-3"}),y(" "+v(i.branchName||"Sucursal Principal"),1)])])):h("",!0),o(a,{icon:"i-heroicons-x-mark",variant:"ghost",color:"white",class:"md:hidden absolute top-4 right-4",onClick:e[1]||(e[1]=r=>s.value=!1)})]),t("nav",H,[o(a,{to:`/${l(n)}/agenda`,variant:"ghost",icon:"i-heroicons-calendar",label:"Agenda",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[2]||(e[2]=r=>s.value=!1)},null,8,["to"]),o(a,{to:`/${l(n)}/clientes`,variant:"ghost",icon:"i-heroicons-users",label:"Clientes",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[3]||(e[3]=r=>s.value=!1)},null,8,["to"]),o(a,{to:`/${l(n)}/reportes`,variant:"ghost",icon:"i-heroicons-currency-dollar",label:"Reportes",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[4]||(e[4]=r=>s.value=!1)},null,8,["to"]),o(a,{to:`/${l(n)}/servicios`,variant:"ghost",icon:"i-heroicons-scissors",label:"Servicios",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[5]||(e[5]=r=>s.value=!1)},null,8,["to"]),o(a,{to:`/${l(n)}/productos`,variant:"ghost",icon:"i-heroicons-cube",label:"Productos",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[6]||(e[6]=r=>s.value=!1)},null,8,["to"]),l(x)==="admin"?(u(),c("div",J,[e[15]||(e[15]=t("span",{class:"px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider"},"Gestión",-1)),o(a,{to:`/${l(n)}/equipo`,variant:"ghost",icon:"i-heroicons-user-group",label:"Personal",block:"",class:"justify-start px-4 py-3 mt-2 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[7]||(e[7]=r=>s.value=!1)},null,8,["to"]),o(a,{to:`/${l(n)}/sucursales`,variant:"ghost",icon:"i-heroicons-building-storefront",label:"Sucursales",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[8]||(e[8]=r=>s.value=!1)},null,8,["to"]),o(a,{to:`/${l(n)}/equipo/roles`,variant:"ghost",icon:"i-heroicons-tag",label:"Gestión de Roles",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[9]||(e[9]=r=>s.value=!1)},null,8,["to"])])):h("",!0),l(x)==="superadmin"?(u(),c("div",K,[e[16]||(e[16]=t("span",{class:"px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider"},"Super Admin",-1)),o(a,{to:"/admin/tenants",variant:"ghost",icon:"i-heroicons-building-office-2",label:"Peluquerías",block:"",class:"justify-start px-4 py-3 mt-2 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-purple-600 text-white hover:bg-purple-500 shadow-lg shadow-purple-900/20",onClick:e[10]||(e[10]=r=>s.value=!1)}),o(a,{to:"/admin/dashboard",variant:"ghost",icon:"i-heroicons-chart-bar",label:"Métricas Globales",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-purple-600 text-white hover:bg-purple-500 shadow-lg shadow-purple-900/20",onClick:e[11]||(e[11]=r=>s.value=!1)})])):h("",!0)]),t("div",X,[t("div",Y,[e[17]||(e[17]=t("span",{class:"text-xs text-slate-500 uppercase font-bold tracking-wider"},"Ajustes",-1)),o(k)]),o(a,{to:`/${l(n)}/configuracion`,color:"gray",variant:"ghost",icon:"i-heroicons-cog-6-tooth",label:"Configuración",block:"",class:"justify-start text-slate-300 hover:text-white hover:bg-slate-800","active-class":"bg-emerald-600 text-white shadow-lg shadow-emerald-900/20",onClick:e[12]||(e[12]=r=>s.value=!1)},null,8,["to"]),o(a,{color:"gray",variant:"ghost",icon:"i-heroicons-arrow-left-on-rectangle",label:"Cerrar Sesión",block:"",class:"justify-start text-slate-400 hover:text-white hover:bg-slate-800",onClick:C}),t("div",Z,[t("span",ee,"v"+v(l($).public.appVersion),1)])])],2),t("div",te,[t("div",se,[e[18]||(e[18]=t("h1",{class:"font-bold text-lg text-slate-900 dark:text-emerald-400 shrink-0"},"GestorEstilista",-1)),l(m)?(u(),c("span",ae,"/")):h("",!0),l(m)?(u(),c("h1",oe,v(l(m)),1)):h("",!0)]),t("div",le,[o(k),o(a,{icon:"i-heroicons-bars-3",variant:"ghost",color:"gray",onClick:e[13]||(e[13]=r=>s.value=!s.value)})])]),t("main",re,[t("div",ne,[T(d.$slots,"default")])])])}}});export{me as default};
