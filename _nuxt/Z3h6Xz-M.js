import{_ as M,b as $}from"./B5me2haN.js";import{_ as E}from"./B6BkTIS0.js";import{_ as I}from"./-HABD6Ae.js";import{a as A,_ as F}from"./BBSTtyTp.js";import{_ as G}from"./BVhQNc7P.js";import{_ as T}from"./CfnJ_uRK.js";import{_ as D}from"./B2xe3f_O.js";import{e as L,f as q,a7 as H,G as W,c as d,a as s,b as o,F as O,s as R,h as n,w as r,i as J,r as v,z as K,o as i,m as Q,t as c,k as U,d as C,y as X,j as Y}from"./BoyDVv4J.js";import"./D6vku3W2.js";import"./DlAUqK2U.js";import"./CzwcVY_m.js";import"./BZKOFq6c.js";import"./DjvB_zsV.js";import"./CjduMhnr.js";const Z={class:"space-y-6"},ee={class:"flex justify-between items-center"},te={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},ae={class:"flex justify-between items-start"},se={class:"text-xl font-bold text-slate-900 dark:text-white"},oe={class:"text-2xl font-extrabold text-emerald-600 dark:text-emerald-400 mt-1"},le={class:"space-y-3 text-sm text-slate-600 dark:text-slate-300 mb-6"},ne={class:"flex items-center gap-2"},re={key:0},ie={key:1},de={class:"flex items-center gap-2"},me={key:0},ce={key:1},ue={key:0,class:"flex items-center gap-2"},_e={key:1,class:"flex items-center gap-2 font-bold text-emerald-600 dark:text-emerald-400"},pe={class:"flex justify-end gap-2"},fe={class:"flex items-center justify-between"},xe={class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"},ve={class:"grid grid-cols-2 gap-4"},be={class:"space-y-2 border-t pt-4 border-gray-100 dark:border-gray-800"},ge={class:"grid grid-cols-2 gap-2"},he={class:"ml-2 text-sm text-slate-500"},ye={class:"flex justify-end gap-3 mt-6"},Fe=L({__name:"plans",setup(ke){const b=q(),P=H("headerTitle",()=>"Planes");P.value="Planes";const h=v([]),m=v(!1),g=v(!1),u=v(null),a=K({name:"",price:0,max_users:1,max_branches:1,active:!0,features:{}}),z=()=>{a.name="",a.price=0,a.max_users=1,a.max_branches=1,a.active=!0,a.features={whatsapp:!1,dominio_personalizado:!1},u.value=null},y=(l=null)=>{z(),l&&(u.value=l,a.name=l.name,a.price=l.price,a.max_users=l.max_users,a.max_branches=l.max_branches,a.active=l.active,a.features={whatsapp:l.features?.whatsapp||!1,dominio_personalizado:l.features?.dominio_personalizado||!1}),m.value=!0},k=async()=>{const{data:l}=await b.from("plans").select("*").order("price",{ascending:!0});l&&(h.value=l)},S=async()=>{g.value=!0;try{if(u.value){const{error:l}=await b.from("plans").update({...a}).eq("id",u.value.id);if(l)throw l}else{const{error:l}=await b.from("plans").insert({...a});if(l)throw l}m.value=!1,await k()}catch(l){alert("Error: "+l.message)}finally{g.value=!1}};return W(()=>{k()}),(l,e)=>{const _=M,N=E,f=$,V=I,x=F,p=A,w=G,j=T,B=D;return i(),d("div",Z,[s("div",ee,[e[11]||(e[11]=s("div",{class:"hidden md:block"},[s("h1",{class:"text-3xl font-extrabold text-slate-900 dark:text-white tracking-tight"},"Planes de Suscripción"),s("p",{class:"text-slate-500 dark:text-slate-400 mt-1"},"Gestiona los niveles de servicio y precios.")],-1)),o(_,{icon:"i-heroicons-plus",label:"Nuevo Plan",color:"emerald",onClick:e[0]||(e[0]=t=>y())})]),s("div",te,[(i(!0),d(O,null,R(n(h),t=>(i(),Q(V,{key:t.id,class:X(["border-2 transition-all hover:border-emerald-500 dark:hover:border-emerald-500",t.active?"border-transparent":"border-slate-200 dark:border-slate-700 opacity-75"])},{header:r(()=>[s("div",ae,[s("div",null,[s("h3",se,c(t.name),1),s("div",oe,[C(" $"+c(t.price.toLocaleString())+" ",1),e[12]||(e[12]=s("span",{class:"text-sm font-normal text-slate-500"},"/mes",-1))])]),o(N,{color:t.active?"emerald":"gray",variant:"subtle"},{default:r(()=>[C(c(t.active?"Activo":"Inactivo"),1)]),_:2},1032,["color"])])]),footer:r(()=>[s("div",pe,[o(_,{size:"sm",color:"gray",variant:"ghost",icon:"i-heroicons-pencil-square",onClick:Ve=>y(t)},null,8,["onClick"])])]),default:r(()=>[s("ul",le,[s("li",ne,[o(f,{name:"i-heroicons-users",class:"text-emerald-500 w-5 h-5"}),t.max_users>=9999?(i(),d("span",re,"Usuarios Ilimitados")):(i(),d("span",ie,"Hasta "+c(t.max_users)+" Usuarios",1))]),s("li",de,[o(f,{name:"i-heroicons-building-storefront",class:"text-emerald-500 w-5 h-5"}),t.max_branches>=9999?(i(),d("span",me,"Sucursales Ilimitadas")):(i(),d("span",ce,"Hasta "+c(t.max_branches)+" Sucursales",1))]),t.features?.whatsapp?(i(),d("li",ue,[o(f,{name:"i-heroicons-chat-bubble-left-right",class:"text-emerald-500 w-5 h-5"}),e[13]||(e[13]=s("span",null,"Notificaciones WhatsApp",-1))])):U("",!0),t.features?.dominio_personalizado?(i(),d("li",_e,[o(f,{name:"i-heroicons-globe-alt",class:"w-5 h-5"}),e[14]||(e[14]=s("span",null,"Dominio Personalizado (.cl)",-1))])):U("",!0)])]),_:2},1032,["class"]))),128))]),o(B,{modelValue:n(m),"onUpdate:modelValue":e[10]||(e[10]=t=>J(m)?m.value=t:null)},{default:r(()=>[o(V,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:r(()=>[s("div",fe,[s("h3",xe,c(n(u)?"Editar Plan":"Nuevo Plan"),1),o(_,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:e[1]||(e[1]=t=>m.value=!1)})])]),default:r(()=>[s("form",{onSubmit:Y(S,["prevent"]),class:"space-y-4 py-2"},[o(p,{label:"Nombre del Plan",name:"name"},{default:r(()=>[o(x,{modelValue:n(a).name,"onUpdate:modelValue":e[2]||(e[2]=t=>n(a).name=t),placeholder:"Ej: Enterprise"},null,8,["modelValue"])]),_:1}),o(p,{label:"Precio Mensual (CLP)",name:"price"},{default:r(()=>[o(x,{modelValue:n(a).price,"onUpdate:modelValue":e[3]||(e[3]=t=>n(a).price=t),type:"number",placeholder:"0"},null,8,["modelValue"])]),_:1}),s("div",ve,[o(p,{label:"Máx. Usuarios",name:"max_users"},{default:r(()=>[o(x,{modelValue:n(a).max_users,"onUpdate:modelValue":e[4]||(e[4]=t=>n(a).max_users=t),type:"number"},null,8,["modelValue"])]),_:1}),o(p,{label:"Máx. Sucursales",name:"max_branches"},{default:r(()=>[o(x,{modelValue:n(a).max_branches,"onUpdate:modelValue":e[5]||(e[5]=t=>n(a).max_branches=t),type:"number"},null,8,["modelValue"])]),_:1})]),s("div",be,[e[15]||(e[15]=s("p",{class:"text-xs font-bold text-gray-500 uppercase tracking-wider"},"Características Base",-1)),s("div",ge,[o(w,{modelValue:n(a).features.whatsapp,"onUpdate:modelValue":e[6]||(e[6]=t=>n(a).features.whatsapp=t),label:"WhatsApp"},null,8,["modelValue"]),o(w,{modelValue:n(a).features.dominio_personalizado,"onUpdate:modelValue":e[7]||(e[7]=t=>n(a).features.dominio_personalizado=t),label:"Dominio Propio"},null,8,["modelValue"])])]),o(p,{label:"Estado",name:"active"},{default:r(()=>[o(j,{modelValue:n(a).active,"onUpdate:modelValue":e[8]||(e[8]=t=>n(a).active=t)},null,8,["modelValue"]),s("span",he,c(n(a).active?"Activo":"Inactivo"),1)]),_:1}),s("div",ye,[o(_,{color:"gray",variant:"ghost",label:"Cancelar",onClick:e[9]||(e[9]=t=>m.value=!1)}),o(_,{type:"submit",color:"emerald",label:n(u)?"Guardar Cambios":"Crear Plan",loading:n(g)},null,8,["label","loading"])])],32)]),_:1})]),_:1},8,["modelValue"])])}}});export{Fe as default};
