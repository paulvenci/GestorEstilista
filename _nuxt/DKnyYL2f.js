import{f as N,_ as $}from"./BK1iGzOX.js";import{_ as j}from"./D-5g-dA9.js";import{k as U,U as S,a1 as I,a3 as E,a0 as w,f as z,l as B,c as i,G as c,a as t,d as k,t as h,b as o,e as u,E as G,I as M,r as V,z as R,o as d,a2 as T}from"./C1tViVxN.js";import"./BWX2_Yhy.js";import"./DlAUqK2U.js";import"./kMxVZpd9.js";import"./BZjOwFyk.js";const q={class:"h-screen h-[100dvh] overflow-hidden bg-slate-50 dark:bg-slate-950 flex text-slate-900 dark:text-slate-100 transition-colors duration-300"},A={class:"px-6 py-4 border-b border-slate-800 shrink-0"},D={key:0,class:"mt-2 animate-fade-in block space-y-0.5"},L={class:"text-sm font-bold text-white truncate"},O={class:"text-xs font-semibold text-emerald-400 truncate"},P={class:"text-xs text-slate-400 flex items-center gap-1"},F={class:"flex-1 p-4 space-y-4 mt-4 overflow-y-auto custom-scrollbar"},W={key:0,class:"pt-4 mt-4 border-t border-slate-800"},H={key:1,class:"pt-4 mt-4 border-t border-slate-800"},J={class:"p-4 border-t border-slate-800 space-y-2 shrink-0"},K={class:"flex justify-between items-center px-2"},Q={class:"text-center pt-2"},X={class:"text-[10px] text-slate-600 dark:text-slate-500"},Y={class:"md:hidden fixed top-0 w-full bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-800 z-40 flex items-center justify-between p-4 shadow-md transition-colors duration-300"},Z={class:"flex items-center gap-2"},ee={key:0,class:"text-slate-400 font-medium"},te={key:1,class:"font-bold text-lg text-slate-900 dark:text-white truncate max-w-[150px]"},se={class:"flex gap-2"},ae={class:"flex-1 overflow-auto bg-slate-50 dark:bg-slate-950 relative w-full flex flex-col pt-16 md:pt-0"},oe={class:"flex-1 p-2 md:p-6 overflow-y-auto"},ve=U({__name:"default",setup(le){const b=S(),y=I(),x=E(),_=T(),m=w("headerTitle"),s=V(!1),f=w("userRole",()=>null),C=async()=>{await b.auth.signOut(),y.push("/login")},r=R({role:null,tenantName:"",branchName:"",fullName:""}),g=async()=>{let n=x.value?.id;if(!n){const{data:{user:a}}=await b.auth.getUser();a&&(n=a.id,console.log("User ID recovered from getUser:",n))}if(!n){console.log("Waiting for user...");return}console.log("Fetching info for user:",n);const{data:e,error:v}=await b.from("profiles").select(`
            role,
            full_name,
            tenants ( name ),
            branches ( name )
        `).eq("id",n).single();if(v){console.error("Error fetching user info:",v);return}e?(f.value=e.role,r.role=e.role,r.fullName=e.full_name||"",r.tenantName=e.tenants?.name||"",r.branchName=e.branches?.name||"",console.log("User Info Loaded:",r)):console.log("No profile found for this user.")};return z(x,()=>{g()},{immediate:!0}),B(()=>{setTimeout(g,1e3)}),(n,e)=>{const v=$,a=N,p=j;return d(),i("div",q,[s.value?(d(),i("div",{key:0,class:"fixed inset-0 bg-slate-900/50 z-40 md:hidden backdrop-blur-sm",onClick:e[0]||(e[0]=l=>s.value=!1)})):c("",!0),t("aside",{class:G(["w-72 bg-slate-900 dark:bg-slate-900/90 text-white flex flex-col shadow-xl border-r border-slate-800 fixed md:static inset-y-0 left-0 z-50 transition-transform duration-300 transform md:transform-none",s.value?"translate-x-0":"-translate-x-full md:translate-x-0"])},[t("div",A,[e[12]||(e[12]=t("h1",{class:"font-extrabold text-2xl tracking-tight text-emerald-400"},[k(" Gestor"),t("span",{class:"text-white"},"Estilista")],-1)),r.tenantName?(d(),i("div",D,[t("div",L,h(r.fullName||"Usuario"),1),t("div",O,h(r.tenantName),1),t("div",P,[o(v,{name:"i-heroicons-map-pin",class:"w-3 h-3"}),k(" "+h(r.branchName||"Sucursal Principal"),1)])])):c("",!0),o(a,{icon:"i-heroicons-x-mark",variant:"ghost",color:"white",class:"md:hidden absolute top-4 right-4",onClick:e[1]||(e[1]=l=>s.value=!1)})]),t("nav",F,[o(a,{to:"/",variant:"ghost",icon:"i-heroicons-calendar",label:"Agenda",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[2]||(e[2]=l=>s.value=!1)}),o(a,{to:"/clients",variant:"ghost",icon:"i-heroicons-users",label:"Clientes",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[3]||(e[3]=l=>s.value=!1)}),o(a,{to:"/sales",variant:"ghost",icon:"i-heroicons-currency-dollar",label:"Caja",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[4]||(e[4]=l=>s.value=!1)}),o(a,{to:"/services",variant:"ghost",icon:"i-heroicons-scissors",label:"Catálogo",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[5]||(e[5]=l=>s.value=!1)}),o(a,{to:"/products",variant:"ghost",icon:"i-heroicons-cube",label:"Inventario",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[6]||(e[6]=l=>s.value=!1)}),u(f)==="admin"?(d(),i("div",W,[e[13]||(e[13]=t("span",{class:"px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider"},"Gestión",-1)),o(a,{to:"/team",variant:"ghost",icon:"i-heroicons-user-group",label:"Equipo",block:"",class:"justify-start px-4 py-3 mt-2 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[7]||(e[7]=l=>s.value=!1)}),o(a,{to:"/branches",variant:"ghost",icon:"i-heroicons-building-storefront",label:"Sucursales",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-emerald-600 text-white hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",onClick:e[8]||(e[8]=l=>s.value=!1)})])):c("",!0),u(f)==="superadmin"?(d(),i("div",H,[e[14]||(e[14]=t("span",{class:"px-4 text-xs font-semibold text-slate-500 uppercase tracking-wider"},"Super Admin",-1)),o(a,{to:"/admin/tenants",variant:"ghost",icon:"i-heroicons-building-office-2",label:"Peluquerías",block:"",class:"justify-start px-4 py-3 mt-2 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-purple-600 text-white hover:bg-purple-500 shadow-lg shadow-purple-900/20",onClick:e[9]||(e[9]=l=>s.value=!1)}),o(a,{to:"/admin/dashboard",variant:"ghost",icon:"i-heroicons-chart-bar",label:"Métricas Globales",block:"",class:"justify-start px-4 py-3 transition-all duration-200 hover:bg-slate-800 dark:hover:bg-slate-800 text-slate-300 hover:text-white","active-class":"bg-purple-600 text-white hover:bg-purple-500 shadow-lg shadow-purple-900/20",onClick:e[10]||(e[10]=l=>s.value=!1)})])):c("",!0)]),t("div",J,[t("div",K,[e[15]||(e[15]=t("span",{class:"text-xs text-slate-500 uppercase font-bold tracking-wider"},"Configuración",-1)),o(p)]),o(a,{color:"gray",variant:"ghost",icon:"i-heroicons-arrow-left-on-rectangle",label:"Cerrar Sesión",block:"",class:"justify-start text-slate-400 hover:text-white hover:bg-slate-800",onClick:C}),t("div",Q,[t("span",X,"v"+h(u(_).public.appVersion),1)])])],2),t("div",Y,[t("div",Z,[e[16]||(e[16]=t("h1",{class:"font-bold text-lg text-slate-900 dark:text-emerald-400 shrink-0"},"GestorEstilista",-1)),u(m)?(d(),i("span",ee,"/")):c("",!0),u(m)?(d(),i("h1",te,h(u(m)),1)):c("",!0)]),t("div",se,[o(p),o(a,{icon:"i-heroicons-bars-3",variant:"ghost",color:"gray",onClick:e[11]||(e[11]=l=>s.value=!s.value)})])]),t("main",ae,[t("div",oe,[M(n.$slots,"default")])])])}}});export{ve as default};
