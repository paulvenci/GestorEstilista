import{f as j,_ as B}from"./BK1iGzOX.js";import{_ as I}from"./CtQBUKAt.js";import{_ as N}from"./Dbnl8vwX.js";import{_ as $,b as F}from"./Bn3KjxKb.js";import{_ as T}from"./DOPkkKYT.js";import{_ as z}from"./eJSVvdZN.js";import{k as G,U as L,a0 as q,l as A,c as u,a as s,b as o,F as D,K as H,e as n,w as r,V as K,r as f,z as O,o as d,D as R,t as c,d as U,E as W,W as J}from"./C1tViVxN.js";import"./BWX2_Yhy.js";import"./DlAUqK2U.js";import"./kMxVZpd9.js";import"./CDog84tH.js";import"./F2Urmy6C.js";const Q={class:"space-y-6"},X={class:"flex justify-between items-center"},Y={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},Z={class:"flex justify-between items-start"},ee={class:"text-xl font-bold text-slate-900 dark:text-white"},te={class:"text-2xl font-extrabold text-emerald-600 dark:text-emerald-400 mt-1"},ae={class:"space-y-3 text-sm text-slate-600 dark:text-slate-300 mb-6"},se={class:"flex items-center gap-2"},oe={key:0},le={key:1},ne={class:"flex items-center gap-2"},re={key:0},ie={key:1},de={class:"flex justify-end gap-2"},ce={class:"flex items-center justify-between"},me={class:"text-base font-semibold leading-6 text-gray-900 dark:text-white"},ue={class:"grid grid-cols-2 gap-4"},_e={class:"ml-2 text-sm text-slate-500"},pe={class:"flex justify-end gap-3 mt-6"},Ee=G({__name:"plans",setup(xe){const v=L(),w=q("headerTitle",()=>"Planes");w.value="Planes";const h=f([]),i=f(!1),b=f(!1),m=f(null),t=O({name:"",price:0,max_users:1,max_branches:1,active:!0,features:{}}),C=()=>{t.name="",t.price=0,t.max_users=1,t.max_branches=1,t.active=!0,t.features={},m.value=null},g=(l=null)=>{C(),l&&(m.value=l,t.name=l.name,t.price=l.price,t.max_users=l.max_users,t.max_branches=l.max_branches,t.active=l.active),i.value=!0},y=async()=>{const{data:l}=await v.from("plans").select("*").order("price",{ascending:!0});l&&(h.value=l)},P=async()=>{b.value=!0;try{if(m.value){const{error:l}=await v.from("plans").update({...t}).eq("id",m.value.id);if(l)throw l}else{const{error:l}=await v.from("plans").insert({...t});if(l)throw l}i.value=!1,await y()}catch(l){alert("Error: "+l.message)}finally{b.value=!1}};return A(()=>{y()}),(l,a)=>{const _=j,S=I,k=B,V=N,x=F,p=$,E=T,M=z;return d(),u("div",Q,[s("div",X,[a[9]||(a[9]=s("div",{class:"hidden md:block"},[s("h1",{class:"text-3xl font-extrabold text-slate-900 dark:text-white tracking-tight"},"Planes de Suscripción"),s("p",{class:"text-slate-500 dark:text-slate-400 mt-1"},"Gestiona los niveles de servicio y precios.")],-1)),o(_,{icon:"i-heroicons-plus",label:"Nuevo Plan",color:"emerald",onClick:a[0]||(a[0]=e=>g())})]),s("div",Y,[(d(!0),u(D,null,H(n(h),e=>(d(),R(V,{key:e.id,class:W(["border-2 transition-all hover:border-emerald-500 dark:hover:border-emerald-500",e.active?"border-transparent":"border-slate-200 dark:border-slate-700 opacity-75"])},{header:r(()=>[s("div",Z,[s("div",null,[s("h3",ee,c(e.name),1),s("div",te,[U(" $"+c(e.price.toLocaleString())+" ",1),a[10]||(a[10]=s("span",{class:"text-sm font-normal text-slate-500"},"/mes",-1))])]),o(S,{color:e.active?"emerald":"gray",variant:"subtle"},{default:r(()=>[U(c(e.active?"Activo":"Inactivo"),1)]),_:2},1032,["color"])])]),footer:r(()=>[s("div",de,[o(_,{size:"sm",color:"gray",variant:"ghost",icon:"i-heroicons-pencil-square",onClick:fe=>g(e)},null,8,["onClick"])])]),default:r(()=>[s("ul",ae,[s("li",se,[o(k,{name:"i-heroicons-users",class:"text-emerald-500"}),e.max_users>=9999?(d(),u("span",oe,"Usuarios Ilimitados")):(d(),u("span",le,"Hasta "+c(e.max_users)+" Usuarios",1))]),s("li",ne,[o(k,{name:"i-heroicons-building-storefront",class:"text-emerald-500"}),e.max_branches>=9999?(d(),u("span",re,"Sucursales Ilimitadas")):(d(),u("span",ie,"Hasta "+c(e.max_branches)+" Sucursales",1))])])]),_:2},1032,["class"]))),128))]),o(M,{modelValue:n(i),"onUpdate:modelValue":a[8]||(a[8]=e=>K(i)?i.value=e:null)},{default:r(()=>[o(V,{ui:{ring:"",divide:"divide-y divide-gray-100 dark:divide-gray-800"}},{header:r(()=>[s("div",ce,[s("h3",me,c(n(m)?"Editar Plan":"Nuevo Plan"),1),o(_,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:a[1]||(a[1]=e=>i.value=!1)})])]),default:r(()=>[s("form",{onSubmit:J(P,["prevent"]),class:"space-y-4 py-2"},[o(p,{label:"Nombre del Plan",name:"name"},{default:r(()=>[o(x,{modelValue:n(t).name,"onUpdate:modelValue":a[2]||(a[2]=e=>n(t).name=e),placeholder:"Ej: Enterprise"},null,8,["modelValue"])]),_:1}),o(p,{label:"Precio Mensual (CLP)",name:"price"},{default:r(()=>[o(x,{modelValue:n(t).price,"onUpdate:modelValue":a[3]||(a[3]=e=>n(t).price=e),type:"number",placeholder:"0"},null,8,["modelValue"])]),_:1}),s("div",ue,[o(p,{label:"Máx. Usuarios",name:"max_users",help:"9999 para ilimitado"},{default:r(()=>[o(x,{modelValue:n(t).max_users,"onUpdate:modelValue":a[4]||(a[4]=e=>n(t).max_users=e),type:"number"},null,8,["modelValue"])]),_:1}),o(p,{label:"Máx. Sucursales",name:"max_branches",help:"9999 para ilimitado"},{default:r(()=>[o(x,{modelValue:n(t).max_branches,"onUpdate:modelValue":a[5]||(a[5]=e=>n(t).max_branches=e),type:"number"},null,8,["modelValue"])]),_:1})]),o(p,{label:"Estado",name:"active"},{default:r(()=>[o(E,{modelValue:n(t).active,"onUpdate:modelValue":a[6]||(a[6]=e=>n(t).active=e)},null,8,["modelValue"]),s("span",_e,c(n(t).active?"Activo":"Inactivo"),1)]),_:1}),s("div",pe,[o(_,{color:"gray",variant:"ghost",label:"Cancelar",onClick:a[7]||(a[7]=e=>i.value=!1)}),o(_,{type:"submit",color:"emerald",label:n(m)?"Guardar Cambios":"Crear Plan",loading:n(b)},null,8,["label","loading"])])],32)]),_:1})]),_:1},8,["modelValue"])])}}});export{Ee as default};
